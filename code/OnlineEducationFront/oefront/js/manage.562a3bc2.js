(function(e){function t(t){for(var a,l,i=t[0],n=t[1],u=t[2],d=0,m=[];d<i.length;d++)l=i[d],r[l]&&m.push(r[l][0]),r[l]=0;for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);c&&c(t);while(m.length)m.shift()();return s.push.apply(s,u||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],a=!0,i=1;i<o.length;i++){var n=o[i];0!==r[n]&&(a=!1)}a&&(s.splice(t--,1),e=l(l.s=o[0]))}return e}var a={},r={manage:0},s=[];function l(t){if(a[t])return a[t].exports;var o=a[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,l),o.l=!0,o.exports}l.m=e,l.c=a,l.d=function(e,t,o){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(l.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(o,a,function(t){return e[t]}.bind(null,a));return o},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],n=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var c=n;s.push([1,"chunk-vendors"]),o()})({1:function(e,t,o){e.exports=o("cdc5")},2244:function(e,t,o){"use strict";var a=o("dd83"),r=o.n(a);r.a},"3db6":function(e,t,o){"use strict";o("6762");var a=o("bc3a"),r=o.n(a);t["a"]={passwordRule:[{required:!0,message:"密码不能为空",trigger:"change"},{min:6,max:15,message:"密码长度为6到15个字符",trigger:"blur"}],telRule:[{required:!0,message:"手机号不能为空",trigger:"change"},{len:11,message:"手机号必须为11位",trigger:"blur"},{validator:function(e,t,o){var a=["3","4","5","7","8"];"1"===t[0]&&a.includes(t[1])?o():o(new Error("手机号不可用，请输入有效的手机号"))},trigger:"blur"},{validator:function(e,t,o){r.a.request({url:"/api/users/checkSame/tel",request:"get",params:{tel:t}}).then(function(e){e.data?o(new Error("手机号已被使用")):o()}).catch(function(e){console.log(e.response)})},trigger:"blur"}],emailRule:[{required:!0,message:"邮箱不能为空",trigger:"change"},{type:"email",message:"邮箱格式有误",trigger:"blur"},{validator:function(e,t,o){r.a.request({url:"/api/users/checkSame/email",request:"get",params:{email:t}}).then(function(e){e.data?o(new Error("邮箱已被使用")):o()}).catch(function(e){console.log(e.response)})},trigger:"blur"}],requireRule:function(e){return{required:!0,message:e,trigger:"change"}},usernameRule:[{required:!0,message:"用户名不能为空",trigger:"change"},{min:3,max:50,message:"用户名长度为3到50个字符",trigger:"change"},{validator:function(e,t,o){r.a.request({url:"/api/users/checkSame/username",request:"get",params:{username:t}}).then(function(e){e.data?o(new Error("用户名已被使用")):o()}).catch(function(e){console.log(e.response)})},trigger:"blur"}]}},"4c12":function(e,t,o){},"52fb":function(e,t,o){"use strict";var a=o("ffc4"),r=o.n(a);r.a},"60fd":function(e,t,o){},"6c20":function(e,t,o){"use strict";var a=o("2b0e"),r=o("2f62"),s=(o("ac4d"),o("8a81"),o("ac6a"),o("bc3a")),l=o.n(s);l.a.defaults.withCredentials=!0;var i={username:"",accessToken:"",loginStatus:!1,userInfo:{assistCourses:[],learnCourses:[],teachCourses:[],email:"",grade:0,major:"",realName:"",sex:"",sno:"",id:"",tno:"",tel:"",university:"",avatarUrl:"",roles:[{id:0,role:""}]}},n={authRequestHead:function(e){return{Authorization:"Bearer "+e.accessToken}},userAvatarUrl:function(e){return""!==e.userInfo.avatarUrl?"http://202.120.40.8:30382/online-edu/static/"+e.userInfo.avatarUrl+"?a="+Math.random():""},userRole:function(e){var t=[],o=!0,a=!1,r=void 0;try{for(var s,l=e.userInfo.roles[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var i=s.value;t.push(i.role)}}catch(n){a=!0,r=n}finally{try{o||null==l.return||l.return()}finally{if(a)throw r}}return t},assistCourses:function(e){return e.userInfo.assistCourses},learnCourses:function(e){return e.userInfo.learnCourses},teachCourses:function(e){return e.userInfo.teachCourses},isStudent:function(){for(var e in i.userInfo.roles)if("ROLE_USER"===i.userInfo.roles[e].role)return!0;return!1},isTeacher:function(){var e=[],t=!0,o=!1,a=void 0;try{for(var r,s=i.userInfo.roles[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var l=r.value;e.push(l.role)}}catch(n){o=!0,a=n}finally{try{t||null==s.return||s.return()}finally{if(o)throw a}}return-1!==e.indexOf("ROLE_TEACHING_ADMIN")},getUserId:function(e){return e.userInfo.id}},u={},c={loginSet:function(e,t){e.username=t.username,e.accessToken=t.accessToken,e.loginStatus=!0,console.log(e)},infoSet:function(e,t){e.userInfo=t,console.log(e)},logOut:function(e){e.username="",e.accessToken="",e.loginStatus=!1,e.userInfo={email:"",grade:0,major:"",realName:"",sex:"",sno:"",tno:"",tel:"",university:"",avatarUrl:"",roles:[{id:0,role:""}]}}},d={state:i,getters:n,actions:u,mutations:c};l.a.defaults.withCredentials=!0;var m={id:0,courseInfo:{},identity:"",paperId:0,paperTitle:0,paperAnswers:0,studentSelectId:0},p={getCourseId:function(e){return e.id},getCourseUrl:function(e){return"/api/courses/"+e.id+"/"},getCourseInfo:function(e){return e.courseInfo},getCourseTitle:function(e){return e.courseInfo.courseTitle},getCourseImg:function(e){return""!==e.courseInfo.avatarUrl?"http://202.120.40.8:30382/online-edu/static/"+e.courseInfo.avatarUrl+"?a="+Math.random():""},isCourseTeacher:function(e){return"STUDENT"!==e.identity},getPaperById:function(e){return function(t){var o=!0,a=!1,r=void 0;try{for(var s,l=e.courseInfo.papers[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var i=s.value;if(i.id===t)return i}}catch(n){a=!0,r=n}finally{try{o||null==l.return||l.return()}finally{if(a)throw r}}}},getSectionList:function(e){var t=[],o=!0,a=!1,r=void 0;try{for(var s,l=e.courseInfo.sectionList[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var i=s.value;t.push({secNo:i.secNo,title:i.title})}}catch(n){a=!0,r=n}finally{try{o||null==l.return||l.return()}finally{if(a)throw r}}return t},getPaperId:function(e){return e.paperId},getPaperAnswers:function(e){return e.paperAnswers}},h={},f={setCourseId:function(e,t){e.id=t},setCourseInfo:function(e,t){e.courseInfo=t},setIdentity:function(e,t){e.identity=t},setPaperId:function(e,t){e.paperId=t},setPaperTitle:function(e,t){e.paperTitle=t},setPaperAnswers:function(e,t){e.paperAnswers=t},setStudentSelectId:function(e,t){e.studentSelectId=t}},b={state:m,getters:p,actions:h,mutations:f};a["default"].use(r["a"]);t["a"]=new r["a"].Store({modules:{user:d,course:b}})},a72a:function(e,t,o){"use strict";var a=o("d1ef"),r=o.n(a);r.a},b96b:function(e,t,o){"use strict";var a=o("60fd"),r=o.n(a);r.a},cdc5:function(e,t,o){"use strict";o.r(t);o("cadf"),o("551c"),o("f751"),o("097d");var a=o("2b0e"),r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"manage"}},[o("div",{staticClass:"nav"},[o("ManageNav")],1),o("div",{staticClass:"showbody"},[o("router-view")],1)])},s=[],l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"ManageNav"}},[o("el-row",{staticClass:"tac"},[o("el-col",{attrs:{span:16}},[o("h3",[e._v("管理")]),o("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{router:"true"}},[o("el-menu-item",{attrs:{index:"1",route:"/ManageUser"}},[o("i",{staticClass:"el-icon-menu"}),o("span",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        用户管理\n                    ")])]),o("el-menu-item",{attrs:{index:"2",route:"/ManageCourse"}},[o("i",{staticClass:"el-icon-copy-document"}),o("span",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        课程管理\n                    ")])]),o("el-menu-item",{attrs:{index:"3",route:"/ManageCoursePrototype"}},[o("i",{staticClass:"el-icon-c-scale-to-original"}),o("span",{attrs:{slot:"title"},slot:"title"},[e._v("\n                        课程原型\n                    ")])])],1)],1)],1)],1)},i=[],n={name:"ManageNav"},u=n,c=(o("b96b"),o("2877")),d=Object(c["a"])(u,l,i,!1,null,"40696de5",null),m=d.exports,p={name:"Manage",components:{ManageNav:m}},h=p,f=(o("2244"),Object(c["a"])(h,r,s,!1,null,"110dcbc0",null)),b=f.exports,g=o("8c4f"),v=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",[o("h3",[e._v("用户管理")]),o("div",{staticClass:"divleft"},[o("el-input",{staticClass:"padding",attrs:{placeholder:"请输入用户名","prefix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),o("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"/api/users/bulkImport","http-request":e.uploadExcel,"on-preview":e.handlePreview,"before-upload":e.beforeUpload,"on-remove":e.handleRemove,"on-progress":e.onUploadProgress,limit:3,"on-exceed":e.handleExceed,"auto-upload":!1,"file-list":e.fileList}},[o("el-button",{staticStyle:{"margin-right":"10px"},attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("点击选择用户信息")]),o("el-button",{attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("点击上传")]),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传.xls或.xlsx文件")])],1)],1),o("div",{staticClass:"divright"}),o("el-table",{staticClass:"usertable",attrs:{data:e.UserData.filter(function(t){return!e.search||t.username.includes(e.search)}),"highlight-current-row":"true"}},[o("el-table-column",[o("el-table-column",{attrs:{type:"index"}}),o("el-table-column",{attrs:{prop:"sno",label:"用户编号","min-width":"35%",sortable:""}}),o("el-table-column",{attrs:{prop:"username",label:"用户名","min-width":"35%",sortable:""}}),o("el-table-column",{attrs:{prop:"role",label:"用户身份","min-width":"25%",sortable:""}}),o("el-table-column",{attrs:{prop:"tel",label:"电话","min-width":"50%"}}),o("el-table-column",{attrs:{prop:"email",label:"邮箱","min-width":"50%"}}),o("el-table-column",{attrs:{prop:"userId",label:"操作",fixed:"right","min-width":"40%"},scopedSlots:e._u([{key:"default",fn:function(t){return["管理员"!==t.row.role?o("span",[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(o){return e.handleEdit(t.$index,t.row)}}},[e._v("\n                                    修改\n                                ")]),o("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(o){return e.handleDel(t.$index,t.row)}}},[e._v("\n                                    删除\n                                ")])],1):o("span",[e._v("无法操作")])]}}])})],1)],1)],1),o("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"lock-scroll":!1,top:"5%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.formRule,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"用户编号"}},[o("el-input",{attrs:{type:"text"},model:{value:e.editForm.sno,callback:function(t){e.$set(e.editForm,"sno",t)},expression:"editForm.sno"}})],1),o("el-form-item",{attrs:{label:"用户名"}},[o("el-input",{attrs:{type:"text"},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),!1===e.editForm.boolrole?o("span",[o("el-form-item",{attrs:{label:"用户身份"}},[o("el-checkbox",{attrs:{label:"教师"},model:{value:e.rolecheck,callback:function(t){e.rolecheck=t},expression:"rolecheck"}},[e._v("授权为教师")])],1)],1):e._e(),o("el-form-item",{attrs:{label:"电话",prop:"tel"}},[o("el-input",{attrs:{type:"text"},model:{value:e.editForm.tel,callback:function(t){e.$set(e.editForm,"tel",t)},expression:"editForm.tel"}})],1),o("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[o("el-input",{attrs:{type:"text"},model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1)],1),o("span",{staticClass:"el-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{nativeOn:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),"create"===e.dialogStatus?o("el-button",{attrs:{type:"primary"},on:{click:e.createData}},[e._v("添加")]):o("el-button",{attrs:{type:"primary"},on:{click:e.updateData}},[e._v("修改")])],1)],1)],1)},F=[],y=(o("7f7f"),o("28a5"),{requestHeader:function(){return{Authorization:"Bearer "+localStorage.getItem("managerToken")}}}),S=o("3db6"),x={name:"ManageUser",data:function(){return{search:"",UserData:[],dialogFormVisible:!1,dialogStatus:"",textMap:{update:"Edit",create:"Create"},editForm:{id:"",sno:"",username:"",email:"",tel:"",role:"学生",boolrole:!1},rolecheck:"",formRule:{tel:S["a"].telRule,email:S["a"].emailRule},fileList:[],excelFlag:!1,excelUploadPercent:0}},methods:{showAllUsers:function(){var e=this;this.$axios.request({url:"/api/users/info/all",method:"get",headers:y.requestHeader()}).then(function(t){console.log(t.data),e.UserData=t.data,"Unauthorized"===t.data&&alert("您没有管理员权限！");for(var o=0;o<e.UserData.length;o++){var a=[];a=t.data[o].roles;for(var r=0;r<a.length;r++){var s=a[r].role;e.UserData[o].role="ROLE_ADMIN"===s?"管理员":"ROLE_TEACHING_ADMIN"===s?"教师":"学生"}}}).catch(function(e){console.log(e.response)})},submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeUpload:function(e){var t=e.name.split(".");return"xls"===t[1]||"xlsx"===t[1]?e:(this.$message.error("上传文件只能是 xls/xlsx 格式!"),!1)},uploadExcel:function(e){var t=this;console.log("正在上传文件");var o=new FormData;o.append("excel",e.file);var a=this;this.$axios.request({url:"/api/users/bulkImport",method:"post",headers:{Authorization:"Bearer "+localStorage.getItem("managerToken"),"Content-Type":"multipart/form-data"},data:o},{onUploadProgress:function(o){o.percent=o.loaded/o.total*100,t.excelUploadPercent=o.percent,e.onProgress(o)}}).then(function(e){console.log(e.data),"Import successfully."===e.data&&alert("上传成功"),a.excelFlag=!1,a.showAllUsers()}).catch(function(e){console.log(e)})},uploadProgress:function(e,t,o){this.excelFlag=!0,this.excelUploadPercent=Math.floor(e.percent),console.log(this.excelUploadPercent)},handleDel:function(e,t){alert(t.username+"已删除")},handleEdit:function(e,t){this.dialogStatus="update",this.dialogFormVisible=!0,this.editForm=Object.assign({},t),"学生"===this.editForm.role?this.editForm.boolrole=!1:this.editForm.boolrole=!0},handleAdd:function(){this.dialogStatus="create",this.dialogFormVisible=!0,this.editForm={sno:"",username:"",email:"",role:"学生",boolrole:!1}},createData:function(){alert("用户添加成功"),this.dialogFormVisible=!1},updateData:function(){var e=this;!0===this.rolecheck&&this.$axios.request({url:"/api/auth/"+this.editForm.id+"/teachingAdmin",method:"post",headers:y.requestHeader()}).then(function(e){console.log(e.data)}).catch(function(e){console.log(e)}),this.$axios.request({url:"/api/users/"+this.editForm.id+"/info/modify",method:"post",headers:y.requestHeader(),data:{email:this.editForm.email,tel:this.editForm.tel,sno:this.editForm.sno}}).then(function(t){console.log(t.data),t.data.id===e.editForm.id&&(e.showAllUsers(),e.dialogFormVisible=!1,alert("修改成功"))}).catch(function(e){console.log(e)})}},mounted:function(){this.showAllUsers()}},C=x,w=(o("a72a"),Object(c["a"])(C,v,F,!1,null,"dc8abcf8",null)),_=w.exports,D=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",[o("h3",[e._v("课程管理")]),o("div",{staticClass:"divleft"},[o("el-input",{staticClass:"padding",attrs:{placeholder:"请输入课程名","prefix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),o("div",{staticClass:"divright"},[o("el-button",{on:{click:e.handleChooseProto}},[e._v("新增")])],1),o("el-table",{staticClass:"coursetable",attrs:{data:e.CourseData.filter(function(t){return!e.search||t.courseTitle.includes(e.search)}),"highlight-current-row":"true"}},[o("el-table-column",[o("el-table-column",{attrs:{type:"index"}}),o("el-table-column",{attrs:{prop:"courseTitle",label:"课程名","min-width":"30%",sortable:""}}),o("el-table-column",{attrs:{prop:"startDate",label:"开始时间","min-width":"30%",sortable:""}}),o("el-table-column",{attrs:{prop:"endDate",label:"结束时间","min-width":"30%",sortable:""}}),o("el-table-column",{attrs:{prop:"location",label:"上课地点","min-width":"35%",sortable:""}}),o("el-table-column",{attrs:{prop:"courseTeacher",label:"授课教师","min-width":"25%",sortable:""}}),o("el-table-column",{attrs:{prop:"courseState",label:"课程状态","min-width":"25%",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{type:t.row.courseStateTemp}},[e._v("\n                                "+e._s(t.row.courseState)+"\n                            ")])]}}])}),o("el-table-column",{attrs:{prop:"id",label:"操作","min-width":"40%"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"button",size:"small"},on:{click:function(o){return e.handleEdit(t.$index,t.row)}}},[e._v("\n                                修改\n                            ")]),o("el-button",{attrs:{type:"button",size:"small"},on:{click:function(o){return e.handleDel(t.$index,t.row)}}},[e._v("\n                                删除\n                            ")])]}}])})],1)],1)],1),o("el-dialog",{attrs:{title:"选择课程原型",visible:e.dialogProtoVisible,"lock-scroll":!1,top:"5%"},on:{"update:visible":function(t){e.dialogProtoVisible=t}}},[o("el-table",{attrs:{data:e.dialogProtoForm,height:"300px"}},[o("el-table-column",{attrs:{type:"index",width:"80%"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-radio",{attrs:{label:t.row.id},model:{value:e.dialogProtoChoose,callback:function(t){e.dialogProtoChoose=t},expression:"dialogProtoChoose"}},[e._v(" ")])]}}])}),o("el-table-column",{attrs:{property:"title",label:"原型名称",sortable:""}}),o("el-table-column",{attrs:{property:"description",label:"描述"}})],1),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{nativeOn:{click:function(t){e.dialogProtoVisible=!1}}},[e._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("创建课程")])],1)],1),o("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"lock-scroll":!1,top:"5%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"课程名"}},[o("el-input",{attrs:{type:"text"},model:{value:e.editForm.courseTitle,callback:function(t){e.$set(e.editForm,"courseTitle",t)},expression:"editForm.courseTitle"}})],1),o("el-form-item",{attrs:{label:"上课日程"}},[o("el-col",{attrs:{span:11}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择开始时间",type:"date","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.editForm.startDate,callback:function(t){e.$set(e.editForm,"startDate",t)},expression:"editForm.startDate"}})],1),o("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),o("el-col",{attrs:{span:11}},[o("el-date-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择结束时间",type:"date","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.editForm.endDate,callback:function(t){e.$set(e.editForm,"endDate",t)},expression:"editForm.endDate"}})],1)],1),o("el-form-item",{attrs:{label:"课时"}},e._l(e.editForm.timeSlots,function(t,a){return o("el-form-item",{key:t.day,attrs:{label:"时间段"+(a+1),rules:{required:!0,message:"内容不能为空",trigger:"blur"}}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.day,callback:function(o){e.$set(t,"day",o)},expression:"timeslot.day"}},e._l(e.options,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),o("el-time-select",{attrs:{"picker-options":{start:"08:00",step:"00:30",end:"20:30"},placeholder:"选择开始时间"},model:{value:t.start,callback:function(o){e.$set(t,"start",o)},expression:"timeslot.start"}}),o("el-time-select",{attrs:{"picker-options":{start:"08:00",step:"00:30",end:"20:30"},placeholder:"选择结束时间"},model:{value:t.end,callback:function(o){e.$set(t,"end",o)},expression:"timeslot.end"}}),o("el-button",{on:{click:function(o){return o.preventDefault(),e.removeTimeslot(t)}}},[e._v("删除")])],1)}),1),o("el-form-item",[o("el-button",{on:{click:e.addTimeslot}},[e._v("新增时间段")])],1),o("el-form-item",{attrs:{label:"上课地点"}},[o("el-input",{attrs:{type:"text"},model:{value:e.editForm.location,callback:function(t){e.$set(e.editForm,"location",t)},expression:"editForm.location"}})],1),"update"===e.dialogStatus?o("el-form-item",{attrs:{label:"授课教师"}},[o("el-input",{attrs:{type:"text"},model:{value:e.editForm.courseTeacher,callback:function(t){e.$set(e.editForm,"courseTeacher",t)},expression:"editForm.courseTeacher"}})],1):e._e(),"进行中"!==e.editForm.courseState&&"已结束"!==e.editForm.courseState&&"update"===e.dialogStatus?o("el-form-item",{attrs:{label:"课程状态"}},[o("el-radio-group",{model:{value:e.editForm.courseState,callback:function(t){e.$set(e.editForm,"courseState",t)},expression:"editForm.courseState"}},[o("el-radio",{attrs:{label:"待审核"}}),o("el-radio",{attrs:{label:"未开始"}}),o("el-radio",{attrs:{label:"未通过"}})],1)],1):e._e()],1),"update"===e.dialogStatus?o("div",[o("el-table",{attrs:{data:e.StudentForm,height:"300px"}},[o("el-table-column",{attrs:{type:"index"}}),o("el-table-column",{attrs:{property:"sno",label:"学号",sortable:""}}),o("el-table-column",{attrs:{property:"username",label:"学生"}}),o("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"button"},on:{click:function(o){return e.DelStudent(t.$index,t.row)}}},[e._v("\n                                删除\n                            ")])]}}],null,!1,2818913736)})],1)],1):e._e(),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{nativeOn:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),"create"===e.dialogStatus?o("el-button",{attrs:{type:"primary"},on:{click:e.createData}},[e._v("\n                    添加\n                ")]):o("el-button",{attrs:{type:"primary"},on:{click:e.updateData}},[e._v("\n                    修改\n                ")])],1)],1)],1)},k=[],U={name:"ManageCourse",data:function(){return{search:"",CourseData:[],dialogFormVisible:!1,dialogProtoVisible:!1,dialogStatus:"",textMap:{update:"Edit",create:"Create"},editForm:{id:0,courseTitle:"",startDate:"",endDate:"",location:"",courseTeacher:"",courseState:"",state:"",timeSlots:[{day:0,end:"",start:""}]},dialogProtoForm:[],dialogProtoChoose:"",addStudent:"",StudentForm:[],options:[{value:"0",label:"周日"},{value:"1",label:"周一"},{value:"2",label:"周二"},{value:"3",label:"周三"},{value:"4",label:"周四"},{value:"5",label:"周五"},{value:"6",label:"周六"}]}},methods:{showAllCourse:function(){var e=this;this.$axios.request({url:"/api/courses/all/info",method:"get",headers:y.requestHeader()}).then(function(t){console.log(t.data),e.CourseData=t.data;for(var o=0;o<e.CourseData.length;o++){var a,r;if(a=t.data[o].state,null!=t.data[o].teacher)r=t.data[o].teacher.username,e.CourseData[o].courseTeacher=r;"APPLYING"===a?(e.CourseData[o].courseStateTemp="warning",e.CourseData[o].courseState="待审核"):"READY_TO_START"===a?(e.CourseData[o].courseStateTemp="primary",e.CourseData[o].courseState="未开始"):"TEACHING"===a?(e.CourseData[o].courseStateTemp="success",e.CourseData[o].courseState="进行中"):"FINISHED"===a?(e.CourseData[o].courseStateTemp="info",e.CourseData[o].courseState="已结束"):"NOT_PASS"===a&&(e.CourseData[o].courseStateTemp="danger",e.CourseData[o].courseState="未通过")}}).catch(function(e){console.log(e.response),alert("请求失败")})},handleDel:function(e,t){alert(t.courseName+"已删除")},handleEdit:function(e,t){this.dialogStatus="update",this.editForm=Object.assign({},t),this.editForm.timeSlots=[{day:0,end:"",start:""}];var o=this;this.$axios.request({url:"/api/courses/"+this.editForm.id+"/students",method:"get",headers:y.requestHeader()}).then(function(e){console.log(e.data),o.StudentForm=e.data}).catch(function(e){console.log(e.response)}),this.dialogFormVisible=!0},handleChooseProto:function(){var e=this;e.dialogProtoForm=[],this.$axios.request({url:"/api/coursePrototypes/info/all",method:"get",headers:y.requestHeader()}).then(function(t){console.log(t.data);for(var o=0;o<t.data.length;o++)"USING"===t.data[o].state&&e.dialogProtoForm.push(t.data[o])}).catch(function(e){console.log(e.response),alert("请求失败")}),this.dialogProtoVisible=!0},handleAdd:function(){this.dialogProtoVisible=!1,this.dialogStatus="create",this.editForm={id:0,courseTitle:"",startDate:"",endDate:"",location:"",courseTeacher:"",courseState:"",state:"",timeSlots:[]},this.editForm.id=this.dialogProtoChoose,this.dialogFormVisible=!0},createData:function(){var e=this;this.$axios.request({url:"/api/courses/start",method:"post",headers:y.requestHeader(),params:{prototypeId:this.editForm.id},data:{courseTitle:this.editForm.courseTitle,startDate:this.editForm.startDate,endDate:this.editForm.endDate,location:this.editForm.location,timeSlots:this.editForm.timeSlots}}).then(function(t){console.log(t.data),e.showAllCourse(),e.dialogFormVisible=!1}).catch(function(e){console.log(e)}),this.dialogFormVisible=!1},updateData:function(){var e=this;"未通过"===this.editForm.courseState?this.editForm.state="disapproval":"未开始"===this.editForm.courseState&&(this.editForm.state="approval"),this.$axios.request({url:"/api/courses/"+this.editForm.id+"/start",method:"post",headers:y.requestHeader(),params:{decision:this.editForm.state}}).then(function(t){console.log(t.data),e.showAllCourse(),e.dialogFormVisible=!1}).catch(function(e){console.log(e)}),this.$axios.request({url:"/api/courses/"+this.editForm.id+"/modify",method:"put",headers:y.requestHeader(),data:{courseTitle:this.editForm.courseTitle,startDate:this.editForm.startDate,endDate:this.editForm.endDate,location:this.editForm.location,timeSlots:this.editForm.timeSlots}}).then(function(t){console.log(t.data),e.showAllCourse(),e.dialogFormVisible=!1,alert("修改课程信息成功")}).catch(function(e){console.log(e)})},AddCourseStudent:function(){alert(this.addStudent+" 该课程添加学生成功")},DelStudent:function(e,t){alert(t.username+"已删除")},removeTimeslot:function(e){var t=this.editForm.timeSlots.indexOf(e);-1!==t&&this.editForm.timeSlots.splice(t,1)},addTimeslot:function(){this.editForm.timeSlots.push({day:"",start:"",end:""})}},mounted:function(){this.showAllCourse()}},P=U,I=(o("fd9a"),Object(c["a"])(P,D,k,!1,null,null,null)),T=I.exports,$=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",[o("h3",[e._v("课程原型管理")]),o("div",{staticClass:"divleft"},[o("el-input",{staticClass:"padding",attrs:{placeholder:"请输入课程名","prefix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),o("div",{staticClass:"divright"},[o("el-button",{on:{click:e.handleAdd}},[e._v("新增")])],1),o("el-table",{staticClass:"coursetable",attrs:{data:e.CourseData.filter(function(t){return!e.search||t.courseName.includes(e.search)}),"highlight-current-row":"true"}},[o("el-table-column",[o("el-table-column",{attrs:{type:"index"}}),o("el-table-column",{attrs:{prop:"title",label:"原型名称","min-width":"30%",sortable:""}}),o("el-table-column",{attrs:{prop:"description",label:"描述","min-width":"40%",sortable:""}}),o("el-table-column",{attrs:{prop:"user",label:"审核用户","min-width":"20%",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"info",plain:"",size:"small"},on:{click:function(o){return e.showUsers(t.$index,t.row)}}},[e._v("\n                                用户详情\n                            ")])]}}])}),o("el-table-column",{attrs:{prop:"courseState",label:"状态","min-width":"25%",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{type:t.row.courseStateTemp}},[e._v("\n                                "+e._s(t.row.courseState)+"\n                            ")])]}}])}),o("el-table-column",{attrs:{prop:"id",label:"操作","min-width":"40%"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"button",size:"small"},on:{click:function(o){return e.handleEdit(t.$index,t.row)}}},[e._v("\n                                修改\n                            ")]),o("el-button",{attrs:{type:"button",size:"small"},on:{click:function(o){return e.handleDel(t.$index,t.row)}}},[e._v("\n                                删除\n                            ")])]}}])})],1)],1)],1),o("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,"lock-scroll":!1,top:"5%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"原型名"}},[o("el-input",{attrs:{type:"text"},model:{value:e.editForm.title,callback:function(t){e.$set(e.editForm,"title",t)},expression:"editForm.title"}})],1),o("el-form-item",{attrs:{label:"描述"}},[o("el-input",{attrs:{type:"text"},model:{value:e.editForm.description,callback:function(t){e.$set(e.editForm,"description",t)},expression:"editForm.description"}})],1),"update"===e.dialogStatus?o("el-form-item",{attrs:{label:"课程状态"}},[o("el-radio-group",{model:{value:e.editForm.courseState,callback:function(t){e.$set(e.editForm,"courseState",t)},expression:"editForm.courseState"}},[o("el-radio",{attrs:{label:"可使用"}}),o("el-radio",{attrs:{label:"未通过"}})],1)],1):e._e()],1),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{nativeOn:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),"create"===e.dialogStatus?o("el-button",{attrs:{type:"primary"},on:{click:e.createData}},[e._v("\n                    添加\n                ")]):o("el-button",{attrs:{type:"primary"},on:{click:e.updateData}},[e._v("\n                    修改\n                ")])],1)],1),o("el-dialog",{attrs:{title:"课程原型相关用户",visible:e.UserDialogVisible,"lock-scroll":!1,top:"5%"},on:{"update:visible":function(t){e.UserDialogVisible=t}}},[o("el-table",{attrs:{data:e.UserForm,height:"500px"}},[o("el-table-column",{attrs:{type:"index"}}),o("el-table-column",{attrs:{property:"username",label:"用户名","min-width":"20%",sortable:""}}),o("el-table-column",{attrs:{property:"state",label:"状态","min-width":"50%",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-radio-group",{model:{value:t.row.userState,callback:function(o){e.$set(t.row,"userState",o)},expression:"scope.row.userState"}},[o("el-radio",{attrs:{label:"未通过"}},[e._v("未通过")]),o("el-radio",{attrs:{label:"可使用"}},[e._v("可使用")]),o("el-radio",{attrs:{label:"待审核"}},[e._v("待审核")])],1)]}}])})],1),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{nativeOn:{click:function(t){e.UserDialogVisible=!1}}},[e._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.manageUser}},[e._v("修改")])],1)],1)],1)},A=[],q={name:"ManageCoursePrototype",data:function(){return{search:"",CourseData:[],dialogFormVisible:!1,UserDialogVisible:!1,dialogStatus:"",textMap:{update:"Edit",create:"Create"},editForm:{id:"",title:"",description:"",courseState:"",state:""},UserForm:[],UserEditForm:{username:"",state:""},CourseIdtoUser:""}},methods:{showAllCoursePrototypes:function(){var e=this;this.$axios.request({url:"/api/coursePrototypes/info/all",method:"get",headers:y.requestHeader()}).then(function(t){console.log(t.data),e.CourseData=t.data;for(var o=0;o<e.CourseData.length;o++){var a;a=t.data[o].state,"NOT_DECIDE"===a?(e.CourseData[o].courseStateTemp="warning",e.CourseData[o].courseState="待审核"):"USING"===a?(e.CourseData[o].courseStateTemp="success",e.CourseData[o].courseState="可使用"):"DENIAL"===a&&(e.CourseData[o].courseStateTemp="danger",e.CourseData[o].courseState="未通过")}}).catch(function(e){console.log(e.response),alert("请求失败")})},handleDel:function(e,t){alert(t.courseName+"已删除")},handleEdit:function(e,t){this.dialogStatus="update",this.dialogFormVisible=!0,this.editForm=Object.assign({},t)},handleAdd:function(){this.dialogStatus="create",this.dialogFormVisible=!0,this.editForm={id:"",title:"",description:"",courseState:""}},createData:function(){var e=this;this.$axios.request({url:"/api/coursePrototypes/",method:"post",headers:y.requestHeader(),data:{title:this.editForm.title,description:this.editForm.description}}).then(function(t){console.log(t.data),e.showAllCoursePrototypes(),e.dialogFormVisible=!1}).catch(function(e){console.log(e)})},updateData:function(){var e=this;"未通过"===this.editForm.courseState?this.editForm.state="disapproval":"可使用"===this.editForm.courseState&&(this.editForm.state="approval"),this.$axios.request({url:"/api/coursePrototypes/"+this.editForm.id+"/create",method:"post",headers:y.requestHeader(),params:{decision:this.editForm.state}}).then(function(t){console.log(t.data),e.showAllCoursePrototypes(),e.dialogFormVisible=!1}).catch(function(e){console.log(e)})},showUsers:function(e,t){var o=this;o.CourseIdtoUser=t.id,o.UserForm=[],this.$axios.request({url:"/api/coursePrototypes/"+t.id+"/applications",method:"get",headers:y.requestHeader()}).then(function(e){console.log(e.data);for(var t=0;t<e.data.length;t++){var a,r=e.data[t];"NOT_DECIDE"===r.state?a="待审核":"APPROVAL"===r.state?a="可使用":"DISAPPROVAL"===r.state&&(a="未通过");var s=r.applicationForCoursePK.teachingAdmin,l={id:s.id,username:s.username,userState:a,decision:""};o.UserForm.push(l)}console.log(o.UserForm)}).catch(function(e){console.log(e)}),this.UserDialogVisible=!0},manageUser:function(){var e=this;console.log(e.UserForm);for(var t=0;t<e.UserForm.length;t++)"未通过"===e.UserForm[t].userState?e.UserForm[t].decision="disapproval":"可使用"===e.UserForm[t].userState&&(e.UserForm[t].decision="approval"),this.$axios.request({url:"/api/coursePrototypes/apply",method:"post",headers:y.requestHeader(),params:{applicant_id:this.UserForm[t].id,coursePrototype_id:this.CourseIdtoUser,decision:this.UserForm[t].decision}}).then(function(t){console.log(t.data),e.showAllCoursePrototypes(),e.UserDialogVisible=!1}).catch(function(e){console.log(e)}),console.log(e.UserForm[t])}},mounted:function(){this.showAllCoursePrototypes()}},V=q,E=(o("52fb"),Object(c["a"])(V,$,A,!1,null,"7f7dec24",null)),M=E.exports;a["default"].use(g["a"]);var O=[{path:"/ManageUser",name:"ManageUser",component:_},{path:"/ManageCourse",name:"ManageCourse",component:T},{path:"/ManageCoursePrototype",name:"ManageCoursePrototype",component:M}],N=new g["a"]({routes:O}),H=o("6c20"),R=o("5c96"),j=o.n(R),L=(o("0fae"),o("bc3a")),z=o.n(L);z.a.defaults.withCredentials=!0,z.a.defaults.baseURL="/online-edu",a["default"].use(j.a),a["default"].prototype.$axios=z.a,z.a.defaults.baseURL="/online-edu",new a["default"]({router:N,store:H["a"],render:function(e){return e(b)}}).$mount("#manage")},d1ef:function(e,t,o){},dd83:function(e,t,o){},fd9a:function(e,t,o){"use strict";var a=o("4c12"),r=o.n(a);r.a},ffc4:function(e,t,o){}});
//# sourceMappingURL=manage.562a3bc2.js.map